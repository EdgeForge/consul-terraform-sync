# This file is generated by Consul NIA.
#
# The HCL blocks, arguments, variables, and values are derived from the
# operator configuration for Consul NIA. Any manual changes to this file
# may not be preserved and could be clobbered by a subsequent update.

testProvider = {
  alias = "tp"
  attr  = "value"
  count = 10
}

services = {
  "api" : {
    name        = "api"
    description = "api service for web"
    addresses = [
{{- with $srv := service "tag.api@dc1"}}
  {{- $last := len $srv | subtract 1}}
    {{- range $i := loop $last}}
      {{- with index $srv $i}}
      {
        address = "{{.Address}}"
        port    = {{.Port}}
      },{{end}}
    {{- end}}
  {{- with index $srv $last}}
      {
        address = "{{.Address}}"
        port    = {{.Port}}
      }
  {{- end}}
{{- end}}
    ]
  },
  "web" : {
    name        = "web"
    description = "web service"
    addresses = [
{{- with $srv := service "web@dc1"}}
  {{- $last := len $srv | subtract 1}}
    {{- range $i := loop $last}}
      {{- with index $srv $i}}
      {
        address = "{{.Address}}"
        port    = {{.Port}}
      },{{end}}
    {{- end}}
  {{- with index $srv $last}}
      {
        address = "{{.Address}}"
        port    = {{.Port}}
      }
  {{- end}}
{{- end}}
    ]
  }
}
